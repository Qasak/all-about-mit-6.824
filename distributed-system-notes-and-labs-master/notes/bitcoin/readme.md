## 比特币协议的运行原理

### 前置内容

#### 非对称加密

![img](https://github.com/Qasak/distributed-system-notes-and-labs/blob/master/notes/bitcoin/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%860.png)

它需要两个密钥，一个是公开密钥，另一个是私有密钥；公钥用作加密，私钥则用作解密。

公钥可以公开，可任意向外发布；私钥不可以公开，必须由用户自行严格秘密保管，绝不透过任何途径向任何人提供，也不会透露给被信任的要通信的另一方。

> eg:浏览器连接时使用网站服务器提供的公钥加密并上传数据，可保证只有信任的网站服务器才能解密得知消息，不必担心敏感个人信息因为在网络上传送而被窃取。



#### 数字签名

![img](https://github.com/Qasak/distributed-system-notes-and-labs/blob/master/notes/bitcoin/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D.png)

相反，如果某一用户使用他的私钥加密明文，任何人都可以用该用户的公钥解密密文

由于私钥只由该用户自己持有，故可以肯定该文件必定出自于该用户；公众可以验证该用户发布的数据或文件是否完整、中途有否曾被篡改，接收者可信赖这些数据、文件**确实来自于该用户**，这被称作数字签名

#### 加密散列函数

![img](https://github.com/Qasak/distributed-system-notes-and-labs/blob/master/notes/bitcoin/%E9%9B%AA%E5%B4%A9%E6%95%88%E5%BA%94avalanche%20effect.png)

是散列函数的一种。它被认为是一种单向函数，也就是说极其难以由散列函数输出的结果，回推输入的数据是什么



这种散列函数的输入数据，通常被称为**消息**（message），而它的输出结果，经常被称为**消息摘要**（message digest）或**摘要**（digest）

### 比特币在本质上是一种加密协议

> 我们发明一个Infocoin

### 1.一份已签署的意向书

如果发明一种数字货币你会面临两个问题：

1. 怎么把某人花掉的钱真正扣除？
2. 怎么防止别人偷我们的钱？

解决方案：花Infocoin的时候，给自己发出的交易打上数字签名

这样，所有人都能验证这笔交易确实是我们自己发起的，而不是其他人冒充

这种方案的问题在于，我们发出交易信息*过后*，有人就可以复制该交易信息

#### 使用序列号使coin具有唯一的可识别性

