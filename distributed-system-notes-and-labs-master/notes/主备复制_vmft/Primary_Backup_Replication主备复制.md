## Primary/Backup Replication

在服务器和网络发生故障时使用复制来提供可用性



Q：复制可以处理哪些类型的故障？

“fail-stop”故障：

单个副本风扇的故障，CPU过热并自行关闭

有人绊倒副本的电源线或网线

软件发现它的磁盘空间不足而停止运行

不是硬件上的缺陷，软件中的错误或者人为配置错误通常不是“fail-stop”

可能相关的（即导致所有副本同时崩溃），但是，有时可以检测到（例如校验和）

Q：复制值得Nx花费吗？

两种主要的复制方法：

状态转移

	主副本执行服务
	
	主服务器向备份发送[新]状态

多副本状态机

	客户端将操作发送到主服务器，
	
		主服务器按顺序发送到备份
	
	所有副本执行所有操作
	
	如果启动状态相同，
	
		同样的操作，
	
		同样的顺序，
	
		确定性，
	
		同样的结束状态。

状态转移更简单

	但状态可能很大，通过网络传输很慢



多副本状态机通常生成较少的网络流量

	与状态相比，操作通常很小
	
	但很难搞定
	
	VM-FT使用多副本状态机，lab 2/3/4也是如此